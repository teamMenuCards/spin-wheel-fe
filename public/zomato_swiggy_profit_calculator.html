<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Zomato/Swiggy Monthly Profit Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f2f5;
      padding: 30px;
      color: #333;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
    }
    .logo-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-bottom: 10px;
    }
    .logo-bar img {
      height: 50px;
    }
    h2 {
  color: #007bff;
  text-align: center;
  font-size: 1.75rem;
  line-height: 1.3;
  word-wrap: break-word;
}

@media (max-width: 480px) {
  h2 {
    font-size: 1.3rem;
  }
}

    label {
      display: block;
      margin-top: 20px;
      font-weight: bold;
    }
    input, select {
  padding: 10px;
  width: 100%;
  max-width: 100%; /* üëà Ensure they don‚Äôt exceed container */
  box-sizing: border-box; /* üëà Include padding in width */
  margin-top: 5px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 1rem;
}

    .row {
      display: flex;
      gap: 10px;
    }
    .row input, .row select {
      flex: 1;
    }
    button {
      margin-top: 25px;
      width: 100%;
      padding: 12px;
      font-size: 1rem;
      color: white;
      background-color: #28a745;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .button-negative {
      background: #dc3545 !important;
    }
    
  .result {
  margin-top: 20px;
  padding: 20px;
  background: #f9f9f9;
  border-left: 5px solid #007bff;
  border-radius: 6px;
}
    .result.negative {
      border-left-color: #dc3545;
    }
    .result.negative::before {
      content: "‚ö†Ô∏è Warning: Your business is running at a loss!";
      display: block;
      font-weight: bold;
      color: #dc3545;
      margin-bottom: 12px;
    }
    .chart-title {
      margin-top: 40px;
      font-size: 1.2rem;
      font-weight: bold;
      text-align: center;
    }
    canvas {
  display: block;
  margin: 20px auto 0;
  max-width: 100%;
  height: auto;
}

/* Make pie chart and its labels wrap properly on small screens */

@media (max-width: 600px) {
  
#expenseChart {
  width: 100% !important;
  height: auto !important;
  aspect-ratio: 1 / 1; /* keeps it square */
  max-width: 350px;
}

@media (max-width: 480px) {
  .container {
    padding: 20px 15px;
  }
}

  .chart-title {
    font-size: 1rem;
    margin-top: 30px;
  }
}

  </style>
</head>
<body>
  <div class="container">
    <div class="logo-bar">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Zomato_logo.png/320px-Zomato_logo.png" alt="Zomato Logo">
      <img src="https://cdn.worldvectorlogo.com/logos/swiggy-1.svg" alt="Swiggy Logo">
    </div>
    <h2>Zomato/Swiggy Monthly Profit Calculator</h2>

    <label>Total Monthly Sales:
      <input type="text" id="totalSales"  oninput="formatInput(this)" onfocus="unformatInput(this)" />
    </label>
    <label>Total Discount Given:
      <input type="text" id="discountGiven" oninput="formatInput(this)" onfocus="unformatInput(this)" />
    </label>
    <label>Platform Commission (%):
      <input type="text" id="commissionPercent"  oninput="formatInput(this)" onfocus="unformatInput(this)" />
    </label>
  <!-- New optional inputs start -->
  <label>Number of Orders Delivered (Optional):
    <input type="text" id="ordersDelivered" oninput="formatInput(this)" onfocus="unformatInput(this)" />
  </label>

  <label>Average Order Value (Optional):
    <input type="text" id="averageOrderValue" oninput="formatInput(this)" onfocus="unformatInput(this)" />
  </label>
<!-- New optional inputs end -->



    <h3 style="margin-top: 30px; font-size: 1rem;">Monthly Operational Cost</h3>

    <label>Food Cost:</label>
    <div class="row">
      <input type="text" id="foodCost"  oninput="formatInput(this)" onfocus="unformatInput(this)" />
      <select id="foodCostType">
        <option value="percent">%</option>
        <option value="amount">‚Çπ</option>
      </select>
    </div>

    <label>Staff Salary:</label>
    <div class="row">
      <input type="text" id="staffSalary"  oninput="formatInput(this)" onfocus="unformatInput(this)" />
      <select id="staffSalaryType">
        <option value="percent">%</option>
        <option value="amount">‚Çπ</option>
      </select>
    </div>

    <label>Electricity & Rent:</label>
    <div class="row">
      <input type="text" id="electricityRent" oninput="formatInput(this)" onfocus="unformatInput(this)" />
      <select id="electricityRentType">
        <option value="percent">%</option>
        <option value="amount">‚Çπ</option>
      </select>
    </div>

    <label>Marketing (Offline & Ads):</label>
    <div class="row">
      <input type="text" id="marketingCost" oninput="formatInput(this)" onfocus="unformatInput(this)" />
      <select id="marketingCostType">
        <option value="percent">%</option>
        <option value="amount">‚Çπ</option>
      </select>
    </div>

    <label>Wastage (Order Cancellations & Food Wastage):</label>
    <div class="row">
      <input type="text" id="wastageCost" oninput="formatInput(this)" onfocus="unformatInput(this)" />
      <select id="wastageCostType">
        <option value="percent">%</option>
        <option value="amount">‚Çπ</option>
      </select>
    </div>

    <label>Miscellaneous (Packaging, Delivery, Staff Food & Accom etc):</label>
    <div class="row">
      <input type="text" id="miscCost" oninput="formatInput(this)" onfocus="unformatInput(this)" />
      <select id="miscCostType">
        <option value="percent">%</option>
        <option value="amount">‚Çπ</option>
      </select>
    </div>

    <button id="calcButton" onclick="calculateMonthlyProfit()">Calculate Monthly Profit</button>
    <h3>üí∞ Monthly Profit Summary</h3>

    <div class="result" id="result"></div>

    <div class="chart-title">Monthly Revenue vs Expense</div>
    <canvas id="barChart" width="400" height="400"></canvas>

    <div class="chart-title">Expense Breakdown</div>
    <canvas id="expenseChart" width="600" height="600"></canvas>
  </div>

  <script>
    const formatInput = (el) => {
      const num = el.value.replace(/,/g, '');
      if (!isNaN(num) && num !== '') {
        el.value = parseFloat(num).toLocaleString('en-IN');
      }
    };
    const unformatInput = (el) => {
      el.value = el.value.replace(/,/g, '');
    };

    function parseValue(id) {
      return parseFloat((document.getElementById(id).value || "0").replace(/,/g, '')) || 0;
    }

    function getCost(id, typeId, base) {
      const val = parseFloat((document.getElementById(id).value || "0").replace(/,/g, '')) || 0;
      const type = document.getElementById(typeId).value;
      return type === 'percent' ? (val / 100) * base : val;
    }

    function calculateMonthlyProfit() {
      const totalSales = parseValue('totalSales');
      const discount = parseValue('discountGiven');
      const commissionPercent = parseValue('commissionPercent');
      const afterDiscount = totalSales - discount;
      const commission = (commissionPercent / 100) * afterDiscount;
      const base = totalSales - commission;

      const food = getCost('foodCost', 'foodCostType', base);
      const staff = getCost('staffSalary', 'staffSalaryType', base);
      const rent = getCost('electricityRent', 'electricityRentType', base);
      const marketing = getCost('marketingCost', 'marketingCostType', base);
      const waste = getCost('wastageCost', 'wastageCostType', base);
      const misc = getCost('miscCost', 'miscCostType', base);

      const totalOperationalCost = food + staff + rent + marketing + waste + misc;
      const totalExpense = discount + commission + totalOperationalCost;
      const netProfit = totalSales - totalExpense;
      const profitPercent = totalSales !== 0 ? (netProfit / totalSales) * 100 : 0;

      const result = document.getElementById("result");
      const button = document.getElementById("calcButton");
      result.className = 'result' + (netProfit < 0 ? ' negative' : '');
      button.className = netProfit < 0 ? 'button-negative' : '';

    const breakEvenNumerator = discount + commission + (staff + rent + misc + marketing + waste);
    const breakEvenDenominator = 1 - (food / totalSales);
    const breakEvenSales = breakEvenDenominator > 0 ? breakEvenNumerator / breakEvenDenominator : 0;


    result.innerHTML = `
    <strong>üìà Total Monthly Sales:</strong> ‚Çπ${totalSales.toLocaleString('en-IN')}<br>
    <strong>üéÅ Discount Given:</strong> ‚Çπ${discount.toLocaleString('en-IN')}<br>
    <strong>üßæ Platform Commission Paid:</strong> ‚Çπ${commission.toLocaleString('en-IN')}<br>
    <strong>üè™ Operational Costs:</strong> ‚Çπ${totalOperationalCost.toLocaleString('en-IN')}<br>
    <strong>üí∏ Total Expense:</strong> ‚Çπ${totalExpense.toLocaleString('en-IN')}<br><br>
    
    <h3>üìä Profit Analysis</h3>
    <strong>‚úÖ Net Profit/Loss:</strong> ‚Çπ${netProfit.toLocaleString('en-IN')}<br>
    <strong>üìä Net Profit/Loss Percentage:</strong> ${profitPercent.toFixed(2)}%<br><br>
    <strong>‚öñÔ∏è Break-Even Sales Required:</strong> ‚Çπ${Math.ceil(breakEvenSales).toLocaleString('en-IN')}
  `;
  
    // Direct Profit if Delivered Directly (No Commission + No Discount)
  const directProfit = totalSales - totalOperationalCost;
  const directProfitPercent = totalSales !== 0 ? (directProfit / totalSales) * 100 : 0;

  // Append direct comparison box
  const directBox = document.createElement('div');
  directBox.className = 'result';
  directBox.innerHTML = `
    <h3>üöö Direct Delivery Scenario (No Zomato/Swiggy)</h3>

    <strong>üí∞ Sales (Direct):</strong>‚Çπ${totalSales.toLocaleString('en-IN')}<br>
    <strong>üè™ Operational Costs:</strong>‚Çπ${totalOperationalCost.toLocaleString('en-IN')}<br><br>
  
   
    <strong>üöÄ Profit (No Commission/ Discount):</strong> ‚Çπ${directProfit.toLocaleString('en-IN')}<br>
    <strong>üìä Profit Margin (Direct):</strong> ${directProfitPercent.toFixed(2)}%

    <br>
    <p style="color: #e23744; font-weight: bold;">‚ö†Ô∏è Direct delivery nearly doubles your profit!</p>


  `;
  result.insertAdjacentElement('afterend', directBox);


      // Bar Chart
      const ctxBar = document.getElementById('barChart').getContext('2d');
      if (window.barChartInstance) window.barChartInstance.destroy();
      window.barChartInstance = new Chart(ctxBar, {
        type: 'bar',
        data: {
          labels: ['Total Monthly Sales', 'Total Expense'],
          datasets: [{
            label: '‚Çπ Value',
            data: [totalSales, totalExpense],
            backgroundColor: ['#007bff', '#dc3545']
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: (value) => '‚Çπ' + value.toLocaleString('en-IN')
              }
            }
          },
          plugins: {
            legend: { display: false },
            tooltip: {
              callbacks: {
                label: (ctx) => `‚Çπ Value: ${ctx.raw.toLocaleString('en-IN')}`
              }
            }
          }
        }
      });

      // Pie Chart
      const ctxPie = document.getElementById('expenseChart').getContext('2d');
      if (window.expenseChartInstance) window.expenseChartInstance.destroy();
      window.expenseChartInstance = new Chart(ctxPie, {
        type: 'pie',
        data: {
          labels: [
            'Food', 'Staff', 'Rent', 'Misc', 'Wastage', 'Marketing',
            'Discount', 'Platform Commission'
          ],
          datasets: [{
            data: [
              food, staff, rent, misc, waste, marketing,
              discount, commission
            ],
            backgroundColor: [
              '#007bff', '#28a745', '#ffc107', '#17a2b8',
              '#fd7e14', '#6f42c1', '#d63384', '#e23744' // Zomato Red
            ]
          }]
        },
        options: {
  responsive: true,
  maintainAspectRatio: true,
  layout: {
    padding: 10
  },
  plugins: {
    legend: { position: 'bottom' },
    datalabels: {
  formatter: (value, ctx) => {
    const data = ctx.chart.data.datasets[0].data;
    const sorted = [...data].sort((a, b) => b - a);
    const top5 = sorted.slice(0, 5);

    const total = data.reduce((sum, val) => sum + val, 0);

    // Show only if this value is in top 5
    if (top5.includes(value)) {
      return ((value / total) * 100).toFixed(1) + '%';
    }
    return null; // Hide label
  },
  color: '#fff',
  font: { weight: 'bold' }
}

  }
},
        plugins: [ChartDataLabels]
      });
    }
  </script>
</body>
</html>

