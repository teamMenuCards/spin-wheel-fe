<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Zomato/Swiggy Monthly Profit Calculator</title>
  <!-- Chart.js & plugin -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f0f2f5;
      padding: 5vw 4vw;
      color: #333;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: #fff;
      padding: 5vw 4vw;
      border-radius: 10px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
    }
    .logo-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-bottom: 10px;
    }
    .logo-bar img {
      height: 50px;
    }
    h2 {
      color: #007bff;
      text-align: center;
      font-size: 6vw;
    }
    label {
      display: block;
      margin-top: 18px;
      font-weight: bold;
    }
    input, select {
      padding: 10px;
      width: 100%;
      margin-top: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 4vw;
    }
    button {
      margin-top: 25px;
      width: 100%;
      padding: 12px;
      font-size: 5vw;
      color: white;
      background-color: #28a745;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      min-height: 44px;
    }
    .button-negative {
      background: #dc3545 !important;
    }
    .result {
      margin-top: 30px;
      padding: 20px;
      background: #f9f9f9;
      border-left: 5px solid #28a745;
      border-radius: 6px;
      overflow-x: auto;
    }
    .result.negative {
      border-left-color: #dc3545;
    }
    .result.negative::before {
      content: "⚠️ Warning: Your business is running at a loss!";
      display: block;
      font-weight: bold;
      color: #dc3545;
      margin-bottom: 12px;
    }
    .chart-title {
      margin-top: 40px;
      font-size: 5vw;
      font-weight: bold;
      text-align: center;
    }
    canvas {
      display: block;
      margin: 25px auto 0;
      max-width: 100%;
      height: auto;
    }
    @media (min-width: 600px) {
      h2 {
        font-size: 2rem;
      }
      input, select {
        font-size: 1rem;
      }
      button {
        font-size: 1rem;
      }
      .chart-title {
        font-size: 1.25rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo-bar">
      <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Zomato_logo.png/320px-Zomato_logo.png" alt="Zomato Logo">
      <img src="https://cdn.worldvectorlogo.com/logos/swiggy-1.svg" alt="Swiggy Logo">
    </div>
    <h2>Zomato/Swiggy Monthly Profit Calculator</h2>

    <label>Order Mode:
      <select id="orderMode">
        <option value="delivery">Delivery</option>
        <option value="dinein">Dine-In</option>
      </select>
    </label>

    <label>Total Monthly Sales (before discount):
      <input type="number" id="totalSales" />
    </label>

    <label>Total Discount Given (₹):
      <input type="number" id="discountGiven" />
    </label>

    <label>Platform Commission (%):
      <input type="number" id="commissionPercent" />
    </label>

    <label>Food Cost:
      <input type="number" id="foodCost" />
      <select id="foodCostType">
        <option value="percent">%</option>
        <option value="amount">₹</option>
      </select>
    </label>

    <label>Staff Salary:
      <input type="number" id="staffSalary" />
      <select id="staffSalaryType">
        <option value="percent">%</option>
        <option value="amount">₹</option>
      </select>
    </label>

    <label>Electricity & Rent:
      <input type="number" id="electricityRent" />
      <select id="electricityRentType">
        <option value="percent">%</option>
        <option value="amount">₹</option>
      </select>
    </label>

    <label>Misc. (Packaging, Transport, etc.):
      <input type="number" id="miscCost" />
      <select id="miscCostType">
        <option value="percent">%</option>
        <option value="amount">₹</option>
      </select>
    </label>

    <label>Order Cancellations & Wastage:
      <input type="number" id="wastageCost" />
      <select id="wastageCostType">
        <option value="percent">%</option>
        <option value="amount">₹</option>
      </select>
    </label>

    <label>Marketing:
      <input type="number" id="marketingCost" />
      <select id="marketingCostType">
        <option value="percent">%</option>
        <option value="amount">₹</option>
      </select>
    </label>

    <button id="calcButton" onclick="calculateMonthlyProfit()">Calculate Monthly Profit</button>

    <div class="result" id="result"></div>

    <div class="chart-title">Expense Breakdown</div>
    <canvas id="expenseChart" width="400" height="300"></canvas>

    <div style="text-align: center; font-size: 14px; margin-top: 30px; color: #777;">
      Powered by <strong>MenuCards</strong>
    </div>
  </div>

  <script>
    function calculateMonthlyProfit() {
      const totalSales = parseFloat(document.getElementById('totalSales').value) || 0;
      const discount = parseFloat(document.getElementById('discountGiven').value) || 0;
      const commissionPercent = parseFloat(document.getElementById('commissionPercent').value) || 0;
      const afterDiscount = totalSales - discount;
      const commission = (commissionPercent / 100) * afterDiscount;
      const payout = afterDiscount - commission;
      const base = totalSales - commission;

      const getCost = (id, typeId) => {
        const val = parseFloat(document.getElementById(id).value) || 0;
        const type = document.getElementById(typeId).value;
        return type === 'percent' ? (val / 100) * base : val;
      };

      const food = getCost('foodCost', 'foodCostType');
      const staff = getCost('staffSalary', 'staffSalaryType');
      const rent = getCost('electricityRent', 'electricityRentType');
      const misc = getCost('miscCost', 'miscCostType');
      const waste = getCost('wastageCost', 'wastageCostType');
      const marketing = getCost('marketingCost', 'marketingCostType');

      const totalExpense = food + staff + rent + misc + waste + marketing;
      const profit = payout - totalExpense;
      const profitPercent = payout !== 0 ? (profit / payout) * 100 : 0;

      const result = document.getElementById("result");
      const button = document.getElementById("calcButton");
      result.className = 'result' + (profit < 0 ? ' negative' : '');
      button.className = profit < 0 ? 'button-negative' : '';

      result.innerHTML = `
        <strong>Total Monthly Sales:</strong> ₹${totalSales.toLocaleString('en-IN')}<br>
        <strong>Total Discount Given:</strong> ₹${discount.toLocaleString('en-IN')}<br>
        <strong>Platform Commission Paid:</strong> ₹${commission.toLocaleString('en-IN')}<br>
        <strong>Total Operational Cost:</strong> ₹${totalExpense.toLocaleString('en-IN')}<br><br>
        <strong>Net Profit:</strong> ₹${profit.toLocaleString('en-IN')}<br>
        <strong>Final Profit Percentage (on payout):</strong> ${profitPercent.toFixed(2)}%
      `;

      const ctx = document.getElementById('expenseChart').getContext('2d');
      new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['Food', 'Staff', 'Rent', 'Misc', 'Wastage', 'Marketing'],
          datasets: [{
            data: [food, staff, rent, misc, waste, marketing],
            backgroundColor: ['#007bff', '#28a745', '#ffc107', '#17a2b8', '#fd7e14', '#6f42c1']
          }]
        },
        options: {
          plugins: {
            legend: { position: 'bottom' },
            datalabels: {
              formatter: (value, ctx) => {
                let total = ctx.chart._metasets[0].total;
                let percentage = ((value / total) * 100).toFixed(1) + '%';
                return percentage;
              },
              color: '#fff',
              font: { weight: 'bold' }
            }
          }
        },
        plugins: [ChartDataLabels]
      });
    }
  </script>
</body>
</html>
